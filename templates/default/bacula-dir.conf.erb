#
# Generated by Chef for <%= node['fqdn'] %>
#

Director {
  Name = "<%= node['bacula']['director']['name'] %>"
  DIRport = <%= node['bacula']['director']['port'] %>
  QueryFile = "/usr/libexec/bacula/query.sql"
  WorkingDirectory = "<%= node['bacula']['director']['working_directory'] %>"
  PidDirectory = "<%= node['bacula']['director']['pid_directory'] %>"
  Maximum Concurrent Jobs = <%= node['bacula']['director']['maximum_concurrent_jobs'] %>
  Password = "<%= @console_password %>"
  Messages = Daemon
}

JobDefs {
  Name = "DefaultJob"
  Type = Backup
  Level = Incremental
  Storage = File
  Messages = Standard
  Pool = Default
  Full Backup Pool = FullPool
  Incremental Backup Pool = IncrPool
  Differential Backup Pool = DiffPool
  Priority = 10
  Write Bootstrap = "<%= node['bacula']['director']['working_directory'] %>/%c.bsr"
}

Catalog {
  Name = MyCatalog
  dbname = "<%= @db_name %>";DB Address = "127.0.0.1"; dbuser = "<%= @db_user %>"; dbpassword = "<%= @db_password %>"
}

Messages {
  Name = Standard
  <% unless node['bacula']['director']['email_on_error'].empty? %>
  mail on error = <%= node['bacula']['director']['email_on_error'].join(', ') %> = all, !skipped, !terminate
  <% end %>
  append = "/var/log/bacula/director.log" = all, !skipped
  catalog = all
}

Messages {
  Name = Daemon
  append = "/var/log/bacula/bacula.log" = all, !skipped
}

@/etc/bacula/conf.d/storage.conf
@|"find /etc/bacula/conf.d/clients -name '*.conf' -type f -exec echo @{} \;"
